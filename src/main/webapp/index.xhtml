<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
  <h:outputStylesheet name="css/style.css"/>
  <h:outputScript name="js/script.js" target="head"/>
  <title>Conversation Rag</title>
</h:head>

<h:body>
  <f:view>

    <!-- Affichage des messages globaux (erreurs, etc.) -->
    <h:messages errorStyle="color: red" showDetail="true" showSummary="false" globalOnly="true"/>

    <h:form id="form">

      <!-- Sélection du rôle de l’API -->
      <p:outputLabel for="rolesysteme" value="Rôle de l'API : "/>
      <p:selectOneMenu id="rolesysteme" value="#{bb.roleSysteme}" editable="true"
                       required="true" requiredMessage="Vous devez indiquer le rôle de l'API"
                       disabled="#{! bb.roleSystemeChangeable}">
        <f:selectItems value="#{bb.rolesSysteme}"/>
      </p:selectOneMenu>
      <h:message for="rolesysteme" errorStyle="color: red"/>

      <!-- Nouveau chat -->
      <h:outputText value="  "/>
      <h:commandButton value="Nouveau chat" action="#{bb.nouveauChat}"/>

      <!-- Disposition en deux colonnes : question/réponse + historique -->
      <h:panelGrid id="paneltotal" columns="2" columnClasses="topAligned,topAligned">

        <!-- Colonne gauche : question et réponse -->
        <h:panelGrid id="panelgauche" columns="1">

          <h:panelGrid id="questionetreponse" columns="1">
            <h:panelGroup>
              <h:outputText value="Question :"/>
              <button type="button" onclick="copyToClipboard('question')">Copier question</button>
              <button type="button" onclick="toutEffacer()">Effacer question et réponse</button>
            </h:panelGroup>

            <h:inputTextarea id="question" value="#{bb.question}" cols="50" rows="5"/>
            <h:commandButton value="Envoyer la question" action="#{bb.envoyer}"/>

            <h:panelGroup>
              <h:outputText value="Réponse :"/>
              <button type="button" onclick="copyToClipboard('reponse')">Copier réponse</button>
            </h:panelGroup>

            <h:inputTextarea id="reponse" value="#{bb.reponse}" cols="50" rows="15" readonly="true"/>
          </h:panelGrid>

        </h:panelGrid>

        <!-- Colonne droite : conversation -->
        <h:panelGrid id="paneldroit" columns="1" style="vertical-align: top;">
          <h:panelGroup>
            <h:outputText value="Conversation :"/>
            <button type="button" onclick="copyToClipboard('conversation')">Copier conversation</button>
          </h:panelGroup>
          <h:inputTextarea id="conversation" rows="30" cols="50" readonly="true"
                           value="#{bb.conversation}" title="Conversation entière"/>
        </h:panelGrid>

      </h:panelGrid>

    </h:form>
  </f:view>
</h:body>
</html>